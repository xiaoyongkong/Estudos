Fiz esse CÃ³digo me baseando no tutorial fornecido pelo site oficial do CodeIgniter
